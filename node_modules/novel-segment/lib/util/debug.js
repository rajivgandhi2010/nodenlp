"use strict";
/**
 * Created by user on 2018/4/19/019.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const POSTAG_1 = require("../POSTAG");
const sort_object_keys2_1 = require("sort-object-keys2");
//export const SYMBOL_DEBUG_KEY = Symbol.for('_debug');
exports.SYMBOL_DEBUG_KEY = '_debug';
function clearTokemDebug(data, returnClone) {
    if (returnClone) {
        return {
            w: data.w,
            p: data.p,
            f: data.f,
        };
    }
    for (let k in data) {
        if (k != 'w' && k != 'p' && k != 'f') {
            delete data[k];
        }
    }
    delete data[exports.SYMBOL_DEBUG_KEY];
    return data;
}
exports.clearTokemDebug = clearTokemDebug;
function debugToken(data, attr, returnToken, ...argv) {
    if (attr) {
        data[exports.SYMBOL_DEBUG_KEY] = Object.assign(data[exports.SYMBOL_DEBUG_KEY] || {}, attr);
    }
    if (returnToken) {
        return data;
    }
    return (data[exports.SYMBOL_DEBUG_KEY] || {});
}
exports.debugToken = debugToken;
function debug_token(ks, returnSource) {
    let ks2 = [];
    ks.map(function (v, index) {
        //v.index = index;
        debugToken(v, {
            index,
        });
        if (v.p) {
            token_add_info(v);
        }
        else if (v.m) {
            v.m.map(token_add_info);
        }
        else {
            ks2.push(v);
        }
    });
    return returnSource ? ks : ks2;
}
exports.debug_token = debug_token;
function token_add_info(v) {
    if (v.p) {
        v.ps = POSTAG_1.POSTAG.zhName(v.p);
        //v.ps_en = POSTAG.enName(v.p);
        let debug = debugToken(v, {
            ps_en: POSTAG_1.POSTAG.enName(v.p),
        });
        v.pp = toHex(v.p);
        if (v.op) {
            v.ops = POSTAG_1.POSTAG.zhName(v.op);
            v.opp = toHex(v.op);
        }
        if (v.m) {
            v.m.map(function (v) {
                if (typeof v == 'string') {
                    return v;
                }
                return token_add_info(v);
            });
        }
        if (debug._source) {
            token_add_info(debug._source);
        }
    }
    if (v) {
        sort_object_keys2_1.default(v, {
            keys: [
                'w',
                'p',
                'f',
                'ps',
                'pp',
                'ow',
                'op',
                'ops',
                'opp',
                'os',
            ],
            useSource: true,
        });
    }
    return v;
}
exports.token_add_info = token_add_info;
function toHex(p) {
    return '0x' + p
        .toString(16)
        .padStart(4, '0')
        .toUpperCase();
}
exports.toHex = toHex;
exports.default = exports;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVidWcuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJkZWJ1Zy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7O0dBRUc7O0FBRUgsc0NBQW1DO0FBRW5DLHlEQUErQztBQUUvQyx1REFBdUQ7QUFDMUMsUUFBQSxnQkFBZ0IsR0FBRyxRQUFRLENBQUM7QUFvQ3pDLFNBQWdCLGVBQWUsQ0FBQyxJQUFvQixFQUFFLFdBQXFCO0lBRTFFLElBQUksV0FBVyxFQUNmO1FBQ0MsT0FBTztZQUNOLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztZQUNULENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztZQUNULENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztTQUNULENBQUM7S0FDRjtJQUVELEtBQUssSUFBSSxDQUFDLElBQUksSUFBSSxFQUNsQjtRQUNDLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxHQUFHLEVBQ3BDO1lBQ0MsT0FBTyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDZjtLQUNEO0lBRUQsT0FBTyxJQUFJLENBQUMsd0JBQWdCLENBQUMsQ0FBQztJQUU5QixPQUFPLElBQWEsQ0FBQztBQUN0QixDQUFDO0FBdEJELDBDQXNCQztBQVVELFNBQWdCLFVBQVUsQ0FBaUQsSUFBTyxFQUNqRixJQUF5QixFQUN6QixXQUFxQixFQUFFLEdBQUcsSUFBSTtJQUc5QixJQUFJLElBQUksRUFDUjtRQUNDLElBQUksQ0FBQyx3QkFBZ0IsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLHdCQUFnQixDQUFDLElBQUksRUFBRSxFQUFFLElBQUksQ0FBQyxDQUFDO0tBQzNFO0lBRUQsSUFBSSxXQUFXLEVBQ2Y7UUFDQyxPQUFPLElBQUksQ0FBQztLQUNaO0lBRUQsT0FBTyxDQUFDLElBQUksQ0FBQyx3QkFBZ0IsQ0FBQyxJQUFJLEVBQUUsQ0FBbUIsQ0FBQztBQUN6RCxDQUFDO0FBaEJELGdDQWdCQztBQUVELFNBQWdCLFdBQVcsQ0FBdUIsRUFBWSxFQUFFLFlBQXNCO0lBRXJGLElBQUksR0FBRyxHQUEwQixFQUFFLENBQUM7SUFFcEMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsRUFBRSxLQUFLO1FBRXhCLGtCQUFrQjtRQUVsQixVQUFVLENBQUMsQ0FBQyxFQUFFO1lBQ2IsS0FBSztTQUNMLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxDQUFDLENBQUMsRUFDUDtZQUNDLGNBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUNsQjthQUNJLElBQUksQ0FBQyxDQUFDLENBQUMsRUFDWjtZQUNDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLGNBQWMsQ0FBQyxDQUFDO1NBQ3hCO2FBRUQ7WUFDQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ1o7SUFDRixDQUFDLENBQUMsQ0FBQztJQUVILE9BQU8sWUFBWSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztBQUNoQyxDQUFDO0FBM0JELGtDQTJCQztBQUVELFNBQWdCLGNBQWMsQ0FBdUIsQ0FBSTtJQUV4RCxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQ1A7UUFDQyxDQUFDLENBQUMsRUFBRSxHQUFHLGVBQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzFCLCtCQUErQjtRQUUvQixJQUFJLEtBQUssR0FBRyxVQUFVLENBQUMsQ0FBQyxFQUFFO1lBQ3pCLEtBQUssRUFBRSxlQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDekIsQ0FBQyxDQUFDO1FBRUgsQ0FBQyxDQUFDLEVBQUUsR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRWxCLElBQUksQ0FBQyxDQUFDLEVBQUUsRUFDUjtZQUNDLENBQUMsQ0FBQyxHQUFHLEdBQUcsZUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDNUIsQ0FBQyxDQUFDLEdBQUcsR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1NBQ3BCO1FBRUQsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUNQO1lBQ0MsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDO2dCQUVsQixJQUFJLE9BQU8sQ0FBQyxJQUFJLFFBQVEsRUFDeEI7b0JBQ0MsT0FBTyxDQUFDLENBQUM7aUJBQ1Q7Z0JBRUQsT0FBTyxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDMUIsQ0FBQyxDQUFDLENBQUM7U0FDSDtRQUVELElBQUksS0FBSyxDQUFDLE9BQU8sRUFDakI7WUFDQyxjQUFjLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQzlCO0tBQ0Q7SUFFRCxJQUFJLENBQUMsRUFDTDtRQUNDLDJCQUFjLENBQUMsQ0FBQyxFQUFFO1lBQ2pCLElBQUksRUFBRTtnQkFDTCxHQUFHO2dCQUNILEdBQUc7Z0JBQ0gsR0FBRztnQkFFSCxJQUFJO2dCQUNKLElBQUk7Z0JBRUosSUFBSTtnQkFDSixJQUFJO2dCQUNKLEtBQUs7Z0JBQ0wsS0FBSztnQkFFTCxJQUFJO2FBQ0o7WUFFRCxTQUFTLEVBQUUsSUFBSTtTQUNmLENBQUMsQ0FBQztLQUNIO0lBRUQsT0FBTyxDQUFDLENBQUM7QUFDVixDQUFDO0FBOURELHdDQThEQztBQUVELFNBQWdCLEtBQUssQ0FBQyxDQUFTO0lBRTlCLE9BQU8sSUFBSSxHQUFHLENBQUM7U0FDYixRQUFRLENBQUMsRUFBRSxDQUFDO1NBQ1osUUFBUSxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUM7U0FDaEIsV0FBVyxFQUFFLENBQ2I7QUFDSCxDQUFDO0FBUEQsc0JBT0M7QUFFRCxrQkFBZSxPQUFtQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDcmVhdGVkIGJ5IHVzZXIgb24gMjAxOC80LzE5LzAxOS5cbiAqL1xuXG5pbXBvcnQgeyBQT1NUQUcgfSBmcm9tICcuLi9QT1NUQUcnO1xuaW1wb3J0IHsgSVdvcmQgfSBmcm9tICcuLi9TZWdtZW50JztcbmltcG9ydCBzb3J0T2JqZWN0S2V5cyBmcm9tICdzb3J0LW9iamVjdC1rZXlzMic7XG5cbi8vZXhwb3J0IGNvbnN0IFNZTUJPTF9ERUJVR19LRVkgPSBTeW1ib2wuZm9yKCdfZGVidWcnKTtcbmV4cG9ydCBjb25zdCBTWU1CT0xfREVCVUdfS0VZID0gJ19kZWJ1Zyc7XG5cbmV4cG9ydCB0eXBlIElXb3JkRGVidWdJbmZvPFQgZXh0ZW5kcyBJV29yZERlYnVnID0gSVdvcmREZWJ1Zz4gPSB7XG5cdFpodFN5bm9ueW1PcHRpbWl6ZXI/OiBib29sZWFuLFxuXHRjb252ZXJ0U3lub255bT86IGJvb2xlYW4sXG5cdGF1dG9DcmVhdGU/OiBib29sZWFuLFxuXG5cdF9zb3VyY2U/OiBUICYgSVdvcmREZWJ1ZyxcblxuXHRpbmRleD86IG51bWJlcixcblx0cHNfZW4/OiBzdHJpbmcsXG5cblx0W2tleTogc3RyaW5nXTogYW55LFxuXHRba2V5OiBudW1iZXJdOiBhbnksXG59XG5cbmV4cG9ydCB0eXBlIElXb3JkRGVidWcgPSBJV29yZCAmIHtcblxuXHRtPzogQXJyYXk8SVdvcmREZWJ1ZyB8IHN0cmluZz4sXG5cblx0cHM/OiBzdHJpbmcsXG5cdHBwPzogc3RyaW5nLFxuXG5cdG93Pzogc3RyaW5nLFxuXHRvcD86IG51bWJlcixcblx0b3BzPzogc3RyaW5nLFxuXHRvcHA/OiBzdHJpbmcsXG5cblx0b3M/OiBib29sZWFuLFxuXG5cdFtTWU1CT0xfREVCVUdfS0VZXT86IElXb3JkRGVidWdJbmZvPElXb3JkRGVidWc+LFxufVxuXG4vLyBAdHMtaWdub3JlXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJUb2tlbURlYnVnKGRhdGE6IElXb3JkRGVidWdJbmZvLCByZXR1cm5DbG9uZT86IGZhbHNlKTogZGF0YSBpcyBJV29yZFxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyVG9rZW1EZWJ1ZyhkYXRhOiBJV29yZERlYnVnSW5mbywgcmV0dXJuQ2xvbmU/OiB0cnVlKTogSVdvcmRcbmV4cG9ydCBmdW5jdGlvbiBjbGVhclRva2VtRGVidWcoZGF0YTogSVdvcmREZWJ1Z0luZm8sIHJldHVybkNsb25lPzogYm9vbGVhbik6IElXb3JkXG57XG5cdGlmIChyZXR1cm5DbG9uZSlcblx0e1xuXHRcdHJldHVybiB7XG5cdFx0XHR3OiBkYXRhLncsXG5cdFx0XHRwOiBkYXRhLnAsXG5cdFx0XHRmOiBkYXRhLmYsXG5cdFx0fTtcblx0fVxuXG5cdGZvciAobGV0IGsgaW4gZGF0YSlcblx0e1xuXHRcdGlmIChrICE9ICd3JyAmJiBrICE9ICdwJyAmJiBrICE9ICdmJylcblx0XHR7XG5cdFx0XHRkZWxldGUgZGF0YVtrXTtcblx0XHR9XG5cdH1cblxuXHRkZWxldGUgZGF0YVtTWU1CT0xfREVCVUdfS0VZXTtcblxuXHRyZXR1cm4gZGF0YSBhcyBJV29yZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlYnVnVG9rZW48VCBleHRlbmRzIElXb3JkRGVidWcsIFUgZXh0ZW5kcyBJV29yZERlYnVnSW5mbz4oZGF0YTogVCxcblx0YXR0cjogVSAmIElXb3JkRGVidWdJbmZvLFxuXHRyZXR1cm5Ub2tlbjogdHJ1ZSwgLi4uYXJndlxuKTogVFxuZXhwb3J0IGZ1bmN0aW9uIGRlYnVnVG9rZW48VCBleHRlbmRzIElXb3JkRGVidWcsIFUgZXh0ZW5kcyBJV29yZERlYnVnSW5mbz4oZGF0YTogVCxcblx0YXR0cj86IFUgJiBJV29yZERlYnVnSW5mbyxcblx0cmV0dXJuVG9rZW4/OiBib29sZWFuLCAuLi5hcmd2XG4pOiBVICYgSVdvcmREZWJ1Z0luZm9cbmV4cG9ydCBmdW5jdGlvbiBkZWJ1Z1Rva2VuPFQgZXh0ZW5kcyBJV29yZERlYnVnLCBVIGV4dGVuZHMgSVdvcmREZWJ1Z0luZm8+KGRhdGE6IFQsXG5cdGF0dHI/OiBVICYgSVdvcmREZWJ1Z0luZm8sXG5cdHJldHVyblRva2VuPzogYm9vbGVhbiwgLi4uYXJndlxuKVxue1xuXHRpZiAoYXR0cilcblx0e1xuXHRcdGRhdGFbU1lNQk9MX0RFQlVHX0tFWV0gPSBPYmplY3QuYXNzaWduKGRhdGFbU1lNQk9MX0RFQlVHX0tFWV0gfHwge30sIGF0dHIpO1xuXHR9XG5cblx0aWYgKHJldHVyblRva2VuKVxuXHR7XG5cdFx0cmV0dXJuIGRhdGE7XG5cdH1cblxuXHRyZXR1cm4gKGRhdGFbU1lNQk9MX0RFQlVHX0tFWV0gfHwge30pIGFzIElXb3JkRGVidWdJbmZvO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVidWdfdG9rZW48VCBleHRlbmRzIElXb3JkRGVidWc+KGtzOiBBcnJheTxUPiwgcmV0dXJuU291cmNlPzogYm9vbGVhbik6IEFycmF5PFQgfCBJV29yZERlYnVnPlxue1xuXHRsZXQga3MyOiBBcnJheTxUIHwgSVdvcmREZWJ1Zz4gPSBbXTtcblxuXHRrcy5tYXAoZnVuY3Rpb24gKHYsIGluZGV4KVxuXHR7XG5cdFx0Ly92LmluZGV4ID0gaW5kZXg7XG5cblx0XHRkZWJ1Z1Rva2VuKHYsIHtcblx0XHRcdGluZGV4LFxuXHRcdH0pO1xuXG5cdFx0aWYgKHYucClcblx0XHR7XG5cdFx0XHR0b2tlbl9hZGRfaW5mbyh2KTtcblx0XHR9XG5cdFx0ZWxzZSBpZiAodi5tKVxuXHRcdHtcblx0XHRcdHYubS5tYXAodG9rZW5fYWRkX2luZm8pO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0a3MyLnB1c2godik7XG5cdFx0fVxuXHR9KTtcblxuXHRyZXR1cm4gcmV0dXJuU291cmNlID8ga3MgOiBrczI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0b2tlbl9hZGRfaW5mbzxUIGV4dGVuZHMgSVdvcmREZWJ1Zz4odjogVClcbntcblx0aWYgKHYucClcblx0e1xuXHRcdHYucHMgPSBQT1NUQUcuemhOYW1lKHYucCk7XG5cdFx0Ly92LnBzX2VuID0gUE9TVEFHLmVuTmFtZSh2LnApO1xuXG5cdFx0bGV0IGRlYnVnID0gZGVidWdUb2tlbih2LCB7XG5cdFx0XHRwc19lbjogUE9TVEFHLmVuTmFtZSh2LnApLFxuXHRcdH0pO1xuXG5cdFx0di5wcCA9IHRvSGV4KHYucCk7XG5cblx0XHRpZiAodi5vcClcblx0XHR7XG5cdFx0XHR2Lm9wcyA9IFBPU1RBRy56aE5hbWUodi5vcCk7XG5cdFx0XHR2Lm9wcCA9IHRvSGV4KHYub3ApO1xuXHRcdH1cblxuXHRcdGlmICh2Lm0pXG5cdFx0e1xuXHRcdFx0di5tLm1hcChmdW5jdGlvbiAodilcblx0XHRcdHtcblx0XHRcdFx0aWYgKHR5cGVvZiB2ID09ICdzdHJpbmcnKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0cmV0dXJuIHY7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gdG9rZW5fYWRkX2luZm8odik7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRpZiAoZGVidWcuX3NvdXJjZSlcblx0XHR7XG5cdFx0XHR0b2tlbl9hZGRfaW5mbyhkZWJ1Zy5fc291cmNlKTtcblx0XHR9XG5cdH1cblxuXHRpZiAodilcblx0e1xuXHRcdHNvcnRPYmplY3RLZXlzKHYsIHtcblx0XHRcdGtleXM6IFtcblx0XHRcdFx0J3cnLFxuXHRcdFx0XHQncCcsXG5cdFx0XHRcdCdmJyxcblxuXHRcdFx0XHQncHMnLFxuXHRcdFx0XHQncHAnLFxuXG5cdFx0XHRcdCdvdycsXG5cdFx0XHRcdCdvcCcsXG5cdFx0XHRcdCdvcHMnLFxuXHRcdFx0XHQnb3BwJyxcblxuXHRcdFx0XHQnb3MnLFxuXHRcdFx0XSxcblxuXHRcdFx0dXNlU291cmNlOiB0cnVlLFxuXHRcdH0pO1xuXHR9XG5cblx0cmV0dXJuIHY7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0b0hleChwOiBudW1iZXIpXG57XG5cdHJldHVybiAnMHgnICsgcFxuXHRcdC50b1N0cmluZygxNilcblx0XHQucGFkU3RhcnQoNCwgJzAnKVxuXHRcdC50b1VwcGVyQ2FzZSgpXG5cdFx0O1xufVxuXG5leHBvcnQgZGVmYXVsdCBleHBvcnRzIGFzIHR5cGVvZiBpbXBvcnQoJy4vZGVidWcnKTtcbiJdfQ==